<section xmlns:th="http://www.thymeleaf.org"
         xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
         layout:decorate="~{fragments/admin-layout}"
         layout:fragment="body">

    <div class="container mt-4">
        <h2 class="mb-4 text-center">üì© Danh s√°ch tin nh·∫Øn</h2>

        <table class="table table-bordered table-hover text-center">
            <thead class="table-light">
            <tr>
                <th>ID</th>
                <th>Ng∆∞·ªùi g·ª≠i</th>
                <th>Email</th>
                <th>N·ªôi dung</th>
                <th>Ph·∫£n h·ªìi</th>
                <th>Th·ªùi gian</th>
                <th>H√†nh ƒë·ªông</th>
            </tr>
            </thead>
            <tbody>
                <tr th:each="msg, stat : ${messages}">
                    <td th:text="${currentPage * 10 + stat.index + 1}"></td>
                    <td th:text="${msg.name}">Ng∆∞·ªùi g·ª≠i</td>
                    <td th:text="${msg.email}">Email</td>
                    <td th:text="${#strings.abbreviate(msg.message, 40)}">N·ªôi dung</td>
                    <td th:text="${msg.reply != null ? 'ƒê√£ ph·∫£n h·ªìi' : 'Ch∆∞a c√≥'}"></td>
                    <td th:text="${#temporals.format(msg.createdAt, 'dd/MM/yyyy HH:mm')}"></td>
                    <td>
                        <a th:href="@{'/admin/chat-messages/view/' + ${msg.messageId}}"
                        class="btn btn-sm btn-info me-1" title="Chi ti·∫øt">
                            <i class="bi bi-eye"></i>
                        </a>

                        <a th:if="${msg.reply == null}"
                        th:href="@{'/admin/chat-messages/reply/' + ${msg.messageId}}"
                        class="btn btn-sm btn-warning me-1" title="Ph·∫£n h·ªìi">
                            <i class="bi bi-reply"></i>
                        </a>

                       <button th:if="${msg.reply != null}"
                                class="btn btn-sm btn-success me-1"
                                title="ƒê√£ ph·∫£n h·ªìi"
                                disabled>
                            <i class="bi bi-check-circle-fill"></i>
                        </button>

                        <a th:href="@{'/admin/chat-messages/delete/' + ${msg.messageId}}"
                        class="btn btn-sm btn-danger"
                        onclick="return confirm('X√°c nh·∫≠n x√≥a tin nh·∫Øn n√†y?')"
                        title="X√≥a">
                            <i class="bi bi-trash"></i>
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="mt-3 d-flex justify-content-center">
            <nav>
                <ul class="pagination">
                    <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                        <a class="page-link" th:href="@{/admin/chat-messages(page=${currentPage - 1})}">&laquo;</a>
                    </li>
                    <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
                        th:classappend="${i == currentPage} ? 'active'">
                        <a class="page-link" th:href="@{/admin/chat-messages(page=${i})}" th:text="${i + 1}"></a>
                    </li>
                    <li class="page-item" th:classappend="${currentPage + 1 == totalPages} ? 'disabled'">
                        <a class="page-link" th:href="@{/admin/chat-messages(page=${currentPage + 1})}">&raquo;</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</section>

